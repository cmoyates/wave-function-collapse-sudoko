import{s as X,n as K,r as ce}from"../chunks/scheduler.CtbWrGNo.js";import{S as Y,i as A,m as Q,g as E,d as V,e as k,t as P,c as x,a as C,b as W,o as v,h as m,j as H,y as J,s as R,f as S,z as L,k as T,q as ne,n as oe,l as D,u as re,v as ie,w as ae,x as ue,A as O}from"../chunks/index.BQ4s0qH2.js";function z(a){return(a==null?void 0:a.length)!==void 0?a:Array.from(a)}function Z(a,t,r){const n=a.slice();return n[4]=t[r],n}function fe(a){let t,r=(a[0].value||a[0].possibleValues[0])+"",n,l;return{c(){t=k("div"),n=P(r),this.h()},l(e){t=x(e,"DIV",{class:!0,style:!0});var o=C(t);n=W(o,r),o.forEach(V),this.h()},h(){v(t,"class","flex h-16 w-16 items-center justify-center border-l border-t border-black text-center text-4xl font-thin"),v(t,"style",l=`border-left: ${a[0].x%3===0?2:1}px black solid; border-top: ${a[0].y%3===0?2:1}px black solid;`)},m(e,o){E(e,t,o),m(t,n)},p(e,o){o&1&&r!==(r=(e[0].value||e[0].possibleValues[0])+"")&&H(n,r),o&1&&l!==(l=`border-left: ${e[0].x%3===0?2:1}px black solid; border-top: ${e[0].y%3===0?2:1}px black solid;`)&&v(t,"style",l)},d(e){e&&V(t)}}}function he(a){let t,r,n=z(a[0].possibleValues),l=[];for(let e=0;e<n.length;e+=1)l[e]=$(Z(a,n,e));return{c(){t=k("div");for(let e=0;e<l.length;e+=1)l[e].c();this.h()},l(e){t=x(e,"DIV",{class:!0,style:!0});var o=C(t);for(let s=0;s<l.length;s+=1)l[s].l(o);o.forEach(V),this.h()},h(){v(t,"class","flex h-16 w-16 items-center justify-center border-l border-t border-black text-center font-thin"),v(t,"style",r=`display: grid; grid-template-columns: repeat(${Math.ceil(Math.sqrt(a[0].possibleValues.length))}, 1fr); font-size: ${Math.ceil(Math.sqrt(a[0].possibleValues.length))===3?14:18}px; border-left: ${a[0].x%3===0?2:1}px black solid; border-top: ${a[0].y%3===0?2:1}px black solid;`)},m(e,o){E(e,t,o);for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(t,null)},p(e,o){if(o&7){n=z(e[0].possibleValues);let s;for(s=0;s<n.length;s+=1){const i=Z(e,n,s);l[s]?l[s].p(i,o):(l[s]=$(i),l[s].c(),l[s].m(t,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}o&1&&r!==(r=`display: grid; grid-template-columns: repeat(${Math.ceil(Math.sqrt(e[0].possibleValues.length))}, 1fr); font-size: ${Math.ceil(Math.sqrt(e[0].possibleValues.length))===3?14:18}px; border-left: ${e[0].x%3===0?2:1}px black solid; border-top: ${e[0].y%3===0?2:1}px black solid;`)&&v(t,"style",r)},d(e){e&&V(t),J(l,e)}}}function $(a){let t,r=a[4]+"",n,l,e,o;function s(){return a[3](a[4])}return{c(){t=k("button"),n=P(r),l=R(),this.h()},l(i){t=x(i,"BUTTON",{class:!0});var h=C(t);n=W(h,r),l=S(h),h.forEach(V),this.h()},h(){v(t,"class","flex items-center justify-center"),t.disabled=a[1]},m(i,h){E(i,t,h),m(t,n),m(t,l),e||(o=L(t,"click",s),e=!0)},p(i,h){a=i,h&1&&r!==(r=a[4]+"")&&H(n,r),h&2&&(t.disabled=a[1])},d(i){i&&V(t),e=!1,o()}}}function de(a){let t;function r(e,o){return e[0].value===null?he:fe}let n=r(a),l=n(a);return{c(){l.c(),t=Q()},l(e){l.l(e),t=Q()},m(e,o){l.m(e,o),E(e,t,o)},p(e,[o]){n===(n=r(e))&&l?l.p(e,o):(l.d(1),l=n(e),l&&(l.c(),l.m(t.parentNode,t)))},i:K,o:K,d(e){e&&V(t),l.d(e)}}}function pe(a,t,r){let{cell:n}=t,{solverRunning:l}=t,{setBaseGridValue:e}=t;const o=s=>{e(n.x,n.y,s)};return a.$$set=s=>{"cell"in s&&r(0,n=s.cell),"solverRunning"in s&&r(1,l=s.solverRunning),"setBaseGridValue"in s&&r(2,e=s.setBaseGridValue)},[n,l,e,o]}class be extends Y{constructor(t){super(),A(this,t,pe,de,X,{cell:0,solverRunning:1,setBaseGridValue:2})}}function ee(a,t,r){const n=a.slice();return n[3]=t[r],n}function te(a,t,r){const n=a.slice();return n[6]=t[r],n}function le(a){let t,r;return t=new be({props:{cell:a[6],solverRunning:a[1],setBaseGridValue:a[2]}}),{c(){re(t.$$.fragment)},l(n){ie(t.$$.fragment,n)},m(n,l){ae(t,n,l),r=!0},p(n,l){const e={};l&1&&(e.cell=n[6]),l&2&&(e.solverRunning=n[1]),l&4&&(e.setBaseGridValue=n[2]),t.$set(e)},i(n){r||(T(t.$$.fragment,n),r=!0)},o(n){D(t.$$.fragment,n),r=!1},d(n){ue(t,n)}}}function se(a){let t,r,n,l=z(a[3]),e=[];for(let s=0;s<l.length;s+=1)e[s]=le(te(a,l,s));const o=s=>D(e[s],1,1,()=>{e[s]=null});return{c(){t=k("div");for(let s=0;s<e.length;s+=1)e[s].c();r=R(),this.h()},l(s){t=x(s,"DIV",{class:!0});var i=C(t);for(let h=0;h<e.length;h+=1)e[h].l(i);r=S(i),i.forEach(V),this.h()},h(){v(t,"class","grid grid-cols-9")},m(s,i){E(s,t,i);for(let h=0;h<e.length;h+=1)e[h]&&e[h].m(t,null);m(t,r),n=!0},p(s,i){if(i&7){l=z(s[3]);let h;for(h=0;h<l.length;h+=1){const B=te(s,l,h);e[h]?(e[h].p(B,i),T(e[h],1)):(e[h]=le(B),e[h].c(),T(e[h],1),e[h].m(t,r))}for(ne(),h=l.length;h<e.length;h+=1)o(h);oe()}},i(s){if(!n){for(let i=0;i<l.length;i+=1)T(e[i]);n=!0}},o(s){e=e.filter(Boolean);for(let i=0;i<e.length;i+=1)D(e[i]);n=!1},d(s){s&&V(t),J(e,s)}}}function ge(a){let t,r,n=z(a[0]),l=[];for(let o=0;o<n.length;o+=1)l[o]=se(ee(a,n,o));const e=o=>D(l[o],1,1,()=>{l[o]=null});return{c(){t=k("div");for(let o=0;o<l.length;o+=1)l[o].c();this.h()},l(o){t=x(o,"DIV",{class:!0});var s=C(t);for(let i=0;i<l.length;i+=1)l[i].l(s);s.forEach(V),this.h()},h(){v(t,"class","grid-cols-9 border-b-2 border-r-2 border-black")},m(o,s){E(o,t,s);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(t,null);r=!0},p(o,[s]){if(s&7){n=z(o[0]);let i;for(i=0;i<n.length;i+=1){const h=ee(o,n,i);l[i]?(l[i].p(h,s),T(l[i],1)):(l[i]=se(h),l[i].c(),T(l[i],1),l[i].m(t,null))}for(ne(),i=n.length;i<l.length;i+=1)e(i);oe()}},i(o){if(!r){for(let s=0;s<n.length;s+=1)T(l[s]);r=!0}},o(o){l=l.filter(Boolean);for(let s=0;s<l.length;s+=1)D(l[s]);r=!1},d(o){o&&V(t),J(l,o)}}}function ve(a,t,r){let{workingGrid:n}=t,{solverRunning:l}=t,{setBaseGridValue:e}=t;return a.$$set=o=>{"workingGrid"in o&&r(0,n=o.workingGrid),"solverRunning"in o&&r(1,l=o.solverRunning),"setBaseGridValue"in o&&r(2,e=o.setBaseGridValue)},[n,l,e]}class me extends Y{constructor(t){super(),A(this,t,ve,ge,X,{workingGrid:0,solverRunning:1,setBaseGridValue:2})}}function _e(a){let t,r,n='<p class="text-4xl font-thin">Wave Function Collapse</p> <p class="-mr-2 text-center text-6xl font-thin tracking-[8px]">Sudoku</p>',l,e,o,s,i,h="Solve",B,w,N="Reset",q,y,G,j,I,c,f,u,g,d,b;return e=new me({props:{workingGrid:a[1],solverRunning:a[2],setBaseGridValue:a[3]}}),{c(){t=k("div"),r=k("div"),r.innerHTML=n,l=R(),re(e.$$.fragment),o=R(),s=k("div"),i=k("button"),i.textContent=h,B=R(),w=k("button"),w.textContent=N,q=R(),y=k("div"),G=k("p"),j=P("Timestep: "),I=P(a[0]),c=P("ms"),f=R(),u=k("input"),this.h()},l(p){t=x(p,"DIV",{class:!0});var _=C(t);r=x(_,"DIV",{class:!0,"data-svelte-h":!0}),O(r)!=="svelte-6jrufy"&&(r.innerHTML=n),l=S(_),ie(e.$$.fragment,_),o=S(_),s=x(_,"DIV",{class:!0});var M=C(s);i=x(M,"BUTTON",{class:!0,"data-svelte-h":!0}),O(i)!=="svelte-4so6ty"&&(i.textContent=h),B=S(M),w=x(M,"BUTTON",{class:!0,"data-svelte-h":!0}),O(w)!=="svelte-1cjh877"&&(w.textContent=N),q=S(M),y=x(M,"DIV",{class:!0});var U=C(y);G=x(U,"P",{class:!0});var F=C(G);j=W(F,"Timestep: "),I=W(F,a[0]),c=W(F,"ms"),F.forEach(V),f=S(U),u=x(U,"INPUT",{type:!0,style:!0,min:!0,max:!0,step:!0}),U.forEach(V),M.forEach(V),_.forEach(V),this.h()},h(){v(r,"class","flex flex-col items-center justify-center"),v(i,"class","rounded border border-black px-4 py-1 font-thin hover:bg-black hover:font-extralight hover:text-white"),v(w,"class","rounded border border-black px-4 py-1 font-thin hover:bg-black hover:font-extralight hover:text-white"),v(G,"class","mb-1 text-sm"),v(u,"type","range"),v(u,"style",""),v(u,"min",0),v(u,"max",1e3),v(u,"step",50),u.value=a[0],v(y,"class","justify- -mt-2 flex flex-col items-center font-thin"),v(s,"class","flex flex-row items-center justify-center space-x-4"),v(t,"class","flex min-h-screen w-full flex-col items-center justify-center space-y-8")},m(p,_){E(p,t,_),m(t,r),m(t,l),ae(e,t,null),m(t,o),m(t,s),m(s,i),m(s,B),m(s,w),m(s,q),m(s,y),m(y,G),m(G,j),m(G,I),m(G,c),m(y,f),m(y,u),g=!0,d||(b=[L(i,"click",a[5]),L(w,"click",a[6]),L(u,"input",a[4])],d=!0)},p(p,[_]){const M={};_&2&&(M.workingGrid=p[1]),_&4&&(M.solverRunning=p[2]),e.$set(M),(!g||_&1)&&H(I,p[0]),(!g||_&1)&&(u.value=p[0])},i(p){g||(T(e.$$.fragment,p),g=!0)},o(p){D(e.$$.fragment,p),g=!1},d(p){p&&V(t),ue(e),d=!1,ce(b)}}}function Ve(a,t,r){let n=0,l=[],e=[],o=!1;for(let c=0;c<9;c++){let f=[];for(let u=0;u<9;u++)f.push({x:u,y:c,value:null,possibleValues:[1,2,3,4,5,6,7,8,9]});e.push(f)}for(let c=0;c<9;c++){let f=[];for(let u=0;u<9;u++)f.push({x:u,y:c,value:null,possibleValues:[1,2,3,4,5,6,7,8,9]});l.push(f)}const s=c=>new Promise(f=>setTimeout(f,c)),i=(c,f)=>{if(f.value!==null){f.possibleValues=[];return}f.possibleValues=[1,2,3,4,5,6,7,8,9];for(let d=0;d<9;d++)f.possibleValues=f.possibleValues.filter(b=>b!==c[f.y][d].value);for(let d=0;d<9;d++)f.possibleValues=f.possibleValues.filter(b=>b!==c[d][f.x].value);const u=Math.floor(f.x/3),g=Math.floor(f.y/3);for(let d=0;d<3;d++)for(let b=0;b<3;b++)f.possibleValues=f.possibleValues.filter(p=>p!==c[d+g*3][b+u*3].value)},h=(c,f)=>{for(let d=0;d<9;d++){const b=c[f.y][d];b.value===null&&i(c,b)}for(let d=0;d<9;d++){const b=c[d][f.x];b.value===null&&i(c,b)}const u=Math.floor(f.x/3),g=Math.floor(f.y/3);for(let d=0;d<3;d++)for(let b=0;b<3;b++){const p=c[d+g*3][b+u*3];p.value===null&&i(c,p)}},B=(c,f,u)=>{l[f][c].value=u,l[f][c].possibleValues=[],console.log("Setting base grid value",c,f,u),h(l,l[f][c]),j(),console.log("Base grid",l),console.log("Working grid",e)},w=c=>{r(0,n=parseInt(c.currentTarget.value))},N=async()=>{if(o)return;r(2,o=!0),await y(),console.log("Complete");let c=I(e);r(2,o=!1),console.log(c?"The puzzle has been solved!":"This puzzle has no solution.")},q=(c,f,u,g)=>{for(let p=0;p<9;p++)if(c[u][p].value===g)return!1;for(let p=0;p<9;p++)if(c[p][f].value===g)return!1;const d=Math.floor(f/3),b=Math.floor(u/3);for(let p=0;p<3;p++)for(let _=0;_<3;_++)if(c[p+b*3][_+d*3].value===g)return!1;return!0},y=async()=>{const{cells:c,lowestEntropy:f}=G(e);if(c.length===0)return!0;if(f===0)return!1;const u=c[Math.floor(Math.random()*c.length)];let g=u.possibleValues.slice();for(;u.possibleValues.length!==0;){const d=u.possibleValues[Math.floor(Math.random()*u.possibleValues.length)];if(!q(e,u.x,u.y,d)){r(1,e[u.y][u.x].possibleValues=e[u.y][u.x].possibleValues.filter(p=>p!==d),e);continue}if(u.value=d,r(1,e[u.y][u.x]=u,e),h(e,u),await s(n),await y())return u.possibleValues=[],!0;await s(n),g=g.filter(p=>p!==d),u.possibleValues=g.slice(),u.value=null,r(1,e[u.y][u.x]=u,e)}return h(e,u),!1},G=c=>{let f=10,u=[];for(let g=0;g<c.length;g++)for(let d=0;d<c[g].length;d++){const b=c[g][d];b.value===null&&(b.possibleValues.length<f?(f=b.possibleValues.length,u=[b]):b.possibleValues.length===f&&u.push(b))}return{cells:u,lowestEntropy:f}},j=()=>{for(let c=0;c<e.length;c++)for(let f=0;f<e[c].length;f++)r(1,e[c][f].value=l[c][f].value,e),r(1,e[c][f].possibleValues=[...l[c][f].possibleValues],e)},I=c=>{for(let f=0;f<c.length;f++)for(let u=0;u<c[f].length;u++)if(c[f][u].value===null)return!1;return!0};return[n,e,o,B,w,N,j]}class ye extends Y{constructor(t){super(),A(this,t,Ve,_e,X,{})}}export{ye as component};
